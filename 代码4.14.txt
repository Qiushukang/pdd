function scMessage() {console.log("顺序为：订单号，规格，姓名，电话，地址，规格编码，数量，备注，收货信息");var arr = [];var arr1 = document.querySelectorAll("div");for (var i = 0; i < arr1.length; i++) {if (arr1[i].getAttribute("data-testid") == "beast-core-table-middle-body") {arr.push(arr1[i]);}}var xmArr = [],dzArr = [],dhArr = [],ddArr = [],skuArr = [],skuNumArr = [],slArr = [],orderArr = [];try {for (var i = 0; i < arr.length; i++) {var list = arr[i];var a = list.querySelector("tbody>tr:nth-child(2)>td:nth-child(6)>div>div:first-child>div>div>div:first-child>div>span");var b = list.querySelector("tbody>tr:nth-child(2)>td:nth-child(6)>div>div:first-child>div>div>div:nth-child(2)");var c = list.querySelector("tbody>tr:nth-child(2)>td:nth-child(6)>div>div:nth-child(2)>span:first-child");var d = list.querySelector("tbody>tr:nth-child(2)>td:nth-child(6)>div>div:nth-child(3)>div>div");var e = list.querySelector("tbody>tr:nth-child(2)>td:first-child>div>div>div:nth-child(4)>div");var f = list.querySelector("tbody>tr:nth-child(2)>td:first-child>div>div>div:nth-child(3)>div>div>div");var g = list.querySelector("tbody>tr:nth-child(2)>td:nth-child(3)");var h = list.querySelector("div.orderTag>div:last-child>div>span");if (!f) {skuNumArr.push("此项无代码");} else {skuNumArr.push(f.innerText.slice(5));}	skuArr.push(e.innerText);xmArr.push(a.innerText + b.innerText);dhArr.push(c.innerHTML);dzArr.push(d.innerText);slArr.push(g.innerText);if (h == null) {orderArr.push(" ");} else {orderArr.push(h.innerHTML);}b.innerHTML;var dd = list.querySelector("tbody>tr:first-child>td>div>div>div>div>span");dd = dd.innerHTML;ddArr.push(dd.slice(5));}for (let name = 0; name < xmArr.length; name++) {if (xmArr[name].indexOf("复制完整信息") != -1) {xmArr[name] = xmArr[name].slice(0, xmArr[name].indexOf("复制完整信息"));}}let tableToExcel = () => {var jsonData = [];for (var i = 0; i < ddArr.length; i++) {jsonData.push({ddh: ddArr[i],name: xmArr[i],phone: dhArr[i],address: dzArr[i],sku: skuArr[i],skuNum: skuNumArr[i],sl: slArr[i],order: orderArr[i]});}let str = `订单号,姓名,电话,地址,商品规格,商品规格编码,数量,备注信息\n`;for (let i = 0; i < jsonData.length; i++) {for (const key in jsonData[i]) {str += `${jsonData[i][key] + '\t'},`;}str += '\n';}const uri = 'data:text/csv;charset=utf-8,\ufeff' + encodeURIComponent(str);const link = document.createElement("a");link.href = uri;link.download = "订单数据表.xlsx";link.click();};let button = document.createElement("button");button.style.position = "absolute";button.style.top = "200px";button.style.right = "20px";button.style.zIndex = "100";button.innerHTML = "生成excel";button.onclick = tableToExcel;document.querySelector("body").appendChild(button);for (let i = 0; i < skuArr.length; i++) {if (skuArr[i].indexOf(",") != -1) {skuArr[i] = skuArr[i].replace(",", " ");}}function bl(arr) {var str = "";for (var i = 0; i < arr.length; i++) {str += "" + arr[i] + "\n";}console.log(str);}function shrXX(xm, tel, address) {var str = "";for (let i = 0; i < xm.length; i++) {str += xm[i] + "," + tel[i] + "," + address[i] + "\n";	}console.log(str);}bl(ddArr);bl(skuArr);bl(xmArr);bl(dhArr);bl(dzArr);bl(skuNumArr);bl(slArr);bl(orderArr);shrXX(xmArr, dhArr, dzArr);} catch (e) {console.log("失效 可能有 1.代码错误or不适配 2.有没有展开的收件人信息");}}const buttons = document.querySelectorAll('button');let targetSpan;buttons.forEach(button => {if (button.textContent.includes('打单发货')) {	targetSpan = button.querySelector('span');};});const targetButton = targetSpan.closest('button');const newButton = document.createElement('text');newButton.style.backgroundColor = "rgb(64, 124, 255)";newButton.style.color = "white";newButton.style.borderRadius = "5px";newButton.style.padding = "5px 12px";newButton.style.width = "80px";newButton.style.marginRight = "18px";newButton.style.fontSize = "14px";newButton.style.textAlign = "center";newButton.textContent = "重载数据";newButton.addEventListener('mouseover', () => {newButton.style.cursor = 'pointer';newButton.style.backgroundColor = 'rgb(41, 88, 208)';});newButton.addEventListener('mouseout', () => {newButton.style.cursor = 'pointer';newButton.style.backgroundColor = 'rgb(64, 124, 255)';});newButton.onclick = scMessage;targetButton.before(newButton);scMessage();